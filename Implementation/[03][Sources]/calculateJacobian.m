clc
clear

syms x_1 x_2 x_3 x_4 x_5 x_6 y_1 y_2 y_3 y_4 y_5 y_6 z_1 z_2 z_3 z_4 z_5 z_6

x = [ x_1 x_2 x_3 x_4 x_5 x_6 y_1 y_2 y_3 y_4 y_5 y_6 z_1 z_2 z_3 z_4 z_5 z_6];

F = [sqrt((x_1-x_2)^2+(y_1-y_2)^2+(z_1-z_2)^2);
     sqrt((x_2-x_3)^2+(y_2-y_3)^2+(z_2-z_3)^2);
     sqrt((x_3-x_1)^2+(y_3-y_1)^2+(z_3-z_1)^2);
     sqrt((x_1-x_4)^2+(y_1-y_4)^2+(z_1-z_4)^2);
     sqrt((x_1-x_5)^2+(y_1-y_5)^2+(z_1-z_5)^2);
     sqrt((x_2-x_5)^2+(y_2-y_5)^2+(z_2-z_5)^2);
     sqrt((x_2-x_6)^2+(y_2-y_6)^2+(z_2-z_6)^2);
     sqrt((x_3-x_6)^2+(y_3-y_6)^2+(z_3-z_6)^2);
     sqrt((x_3-x_4)^2+(y_3-y_4)^2+(z_3-z_4)^2);
     sqrt((x_4-x_5)^2+(y_4-y_5)^2+(z_4-z_5)^2);
     sqrt((x_5-x_6)^2+(y_5-y_6)^2+(z_5-z_6)^2);
     sqrt((x_6-x_4)^2+(y_6-y_4)^2+(z_6-z_4)^2)];


R = jacobian(F,x);

r = subs(R,x,[-1.5 0 0 0 0 1 0 0 -1 0 1 0 0 -1 0 1 0 0]);


lengths = r*[-1.5 0 0 0 0 1 0 0 -1 0 1 0 0 -1 0 1 0 0]'
% trussNodes  =  [-1.4 0 0; ...  % Node 1 x,y,z
%                 0 0 -1.2; ...  % Node 2 x,y,z
%                 0 -1 0; ...  % Node 3
%                 0 0 1.1; ...  % ...
%                 0 1 0; ...
%                 1 0 0; ...
%                 ];

% x = [ x_1 y_1 z_1;
%       x_2 y_2 z_2;
%       x_3 y_3 z_3;
%       x_4 y_4 z_4;
%       x_5 y_5 z_5;
%       x_6 y_6 z_6];

% [(0.5000*(2*x_1 - 2*x_2))/((x_1 - x_2)^2 + (y_1 - y_2)^2 + (z_1 - z_2)^2)^0.5000, -(0.5000*(2*x_1 - 2*x_2))/((x_1 - x_2)^2 + (y_1 - y_2)^2 + (z_1 - z_2)^2)^0.5000,                                                                                0,                                                                                0,                                                                                0,                                                                                0, (0.5000*(2*y_1 - 2*y_2))/((x_1 - x_2)^2 + (y_1 - y_2)^2 + (z_1 - z_2)^2)^0.5000, -(0.5000*(2*y_1 - 2*y_2))/((x_1 - x_2)^2 + (y_1 - y_2)^2 + (z_1 - z_2)^2)^0.5000,                                                                                0,                                                                                0,                                                                                0,                                                                                0, (0.5000*(2*z_1 - 2*z_2))/((x_1 - x_2)^2 + (y_1 - y_2)^2 + (z_1 - z_2)^2)^0.5000, -(0.5000*(2*z_1 - 2*z_2))/((x_1 - x_2)^2 + (y_1 - y_2)^2 + (z_1 - z_2)^2)^0.5000,                                                                                0,                                                                                0,                                                                                0,                                                                                0]
% [                                                                              0,  (0.5000*(2*x_2 - 2*x_3))/((x_2 - x_3)^2 + (y_2 - y_3)^2 + (z_2 - z_3)^2)^0.5000, -(0.5000*(2*x_2 - 2*x_3))/((x_2 - x_3)^2 + (y_2 - y_3)^2 + (z_2 - z_3)^2)^0.5000,                                                                                0,                                                                                0,                                                                                0,                                                                               0,  (0.5000*(2*y_2 - 2*y_3))/((x_2 - x_3)^2 + (y_2 - y_3)^2 + (z_2 - z_3)^2)^0.5000, -(0.5000*(2*y_2 - 2*y_3))/((x_2 - x_3)^2 + (y_2 - y_3)^2 + (z_2 - z_3)^2)^0.5000,                                                                                0,                                                                                0,                                                                                0,                                                                               0,  (0.5000*(2*z_2 - 2*z_3))/((x_2 - x_3)^2 + (y_2 - y_3)^2 + (z_2 - z_3)^2)^0.5000, -(0.5000*(2*z_2 - 2*z_3))/((x_2 - x_3)^2 + (y_2 - y_3)^2 + (z_2 - z_3)^2)^0.5000,                                                                                0,                                                                                0,                                                                                0]
% [(0.5000*(2*x_1 - 2*x_3))/((x_1 - x_3)^2 + (y_1 - y_3)^2 + (z_1 - z_3)^2)^0.5000,                                                                                0, -(0.5000*(2*x_1 - 2*x_3))/((x_1 - x_3)^2 + (y_1 - y_3)^2 + (z_1 - z_3)^2)^0.5000,                                                                                0,                                                                                0,                                                                                0, (0.5000*(2*y_1 - 2*y_3))/((x_1 - x_3)^2 + (y_1 - y_3)^2 + (z_1 - z_3)^2)^0.5000,                                                                                0, -(0.5000*(2*y_1 - 2*y_3))/((x_1 - x_3)^2 + (y_1 - y_3)^2 + (z_1 - z_3)^2)^0.5000,                                                                                0,                                                                                0,                                                                                0, (0.5000*(2*z_1 - 2*z_3))/((x_1 - x_3)^2 + (y_1 - y_3)^2 + (z_1 - z_3)^2)^0.5000,                                                                                0, -(0.5000*(2*z_1 - 2*z_3))/((x_1 - x_3)^2 + (y_1 - y_3)^2 + (z_1 - z_3)^2)^0.5000,                                                                                0,                                                                                0,                                                                                0]
% [(0.5000*(2*x_1 - 2*x_4))/((x_1 - x_4)^2 + (y_1 - y_4)^2 + (z_1 - z_4)^2)^0.5000,                                                                                0,                                                                                0, -(0.5000*(2*x_1 - 2*x_4))/((x_1 - x_4)^2 + (y_1 - y_4)^2 + (z_1 - z_4)^2)^0.5000,                                                                                0,                                                                                0, (0.5000*(2*y_1 - 2*y_4))/((x_1 - x_4)^2 + (y_1 - y_4)^2 + (z_1 - z_4)^2)^0.5000,                                                                                0,                                                                                0, -(0.5000*(2*y_1 - 2*y_4))/((x_1 - x_4)^2 + (y_1 - y_4)^2 + (z_1 - z_4)^2)^0.5000,                                                                                0,                                                                                0, (0.5000*(2*z_1 - 2*z_4))/((x_1 - x_4)^2 + (y_1 - y_4)^2 + (z_1 - z_4)^2)^0.5000,                                                                                0,                                                                                0, -(0.5000*(2*z_1 - 2*z_4))/((x_1 - x_4)^2 + (y_1 - y_4)^2 + (z_1 - z_4)^2)^0.5000,                                                                                0,                                                                                0]
% [(0.5000*(2*x_1 - 2*x_5))/((x_1 - x_5)^2 + (y_1 - y_5)^2 + (z_1 - z_5)^2)^0.5000,                                                                                0,                                                                                0,                                                                                0, -(0.5000*(2*x_1 - 2*x_5))/((x_1 - x_5)^2 + (y_1 - y_5)^2 + (z_1 - z_5)^2)^0.5000,                                                                                0, (0.5000*(2*y_1 - 2*y_5))/((x_1 - x_5)^2 + (y_1 - y_5)^2 + (z_1 - z_5)^2)^0.5000,                                                                                0,                                                                                0,                                                                                0, -(0.5000*(2*y_1 - 2*y_5))/((x_1 - x_5)^2 + (y_1 - y_5)^2 + (z_1 - z_5)^2)^0.5000,                                                                                0, (0.5000*(2*z_1 - 2*z_5))/((x_1 - x_5)^2 + (y_1 - y_5)^2 + (z_1 - z_5)^2)^0.5000,                                                                                0,                                                                                0,                                                                                0, -(0.5000*(2*z_1 - 2*z_5))/((x_1 - x_5)^2 + (y_1 - y_5)^2 + (z_1 - z_5)^2)^0.5000,                                                                                0]
% [                                                                              0,  (0.5000*(2*x_2 - 2*x_5))/((x_2 - x_5)^2 + (y_2 - y_5)^2 + (z_2 - z_5)^2)^0.5000,                                                                                0,                                                                                0, -(0.5000*(2*x_2 - 2*x_5))/((x_2 - x_5)^2 + (y_2 - y_5)^2 + (z_2 - z_5)^2)^0.5000,                                                                                0,                                                                               0,  (0.5000*(2*y_2 - 2*y_5))/((x_2 - x_5)^2 + (y_2 - y_5)^2 + (z_2 - z_5)^2)^0.5000,                                                                                0,                                                                                0, -(0.5000*(2*y_2 - 2*y_5))/((x_2 - x_5)^2 + (y_2 - y_5)^2 + (z_2 - z_5)^2)^0.5000,                                                                                0,                                                                               0,  (0.5000*(2*z_2 - 2*z_5))/((x_2 - x_5)^2 + (y_2 - y_5)^2 + (z_2 - z_5)^2)^0.5000,                                                                                0,                                                                                0, -(0.5000*(2*z_2 - 2*z_5))/((x_2 - x_5)^2 + (y_2 - y_5)^2 + (z_2 - z_5)^2)^0.5000,                                                                                0]
% [                                                                              0,  (0.5000*(2*x_2 - 2*x_6))/((x_2 - x_6)^2 + (y_2 - y_6)^2 + (z_2 - z_6)^2)^0.5000,                                                                                0,                                                                                0,                                                                                0, -(0.5000*(2*x_2 - 2*x_6))/((x_2 - x_6)^2 + (y_2 - y_6)^2 + (z_2 - z_6)^2)^0.5000,                                                                               0,  (0.5000*(2*y_2 - 2*y_6))/((x_2 - x_6)^2 + (y_2 - y_6)^2 + (z_2 - z_6)^2)^0.5000,                                                                                0,                                                                                0,                                                                                0, -(0.5000*(2*y_2 - 2*y_6))/((x_2 - x_6)^2 + (y_2 - y_6)^2 + (z_2 - z_6)^2)^0.5000,                                                                               0,  (0.5000*(2*z_2 - 2*z_6))/((x_2 - x_6)^2 + (y_2 - y_6)^2 + (z_2 - z_6)^2)^0.5000,                                                                                0,                                                                                0,                                                                                0, -(0.5000*(2*z_2 - 2*z_6))/((x_2 - x_6)^2 + (y_2 - y_6)^2 + (z_2 - z_6)^2)^0.5000]
% [                                                                              0,                                                                                0,  (0.5000*(2*x_3 - 2*x_6))/((x_3 - x_6)^2 + (y_3 - y_6)^2 + (z_3 - z_6)^2)^0.5000,                                                                                0,                                                                                0, -(0.5000*(2*x_3 - 2*x_6))/((x_3 - x_6)^2 + (y_3 - y_6)^2 + (z_3 - z_6)^2)^0.5000,                                                                               0,                                                                                0,  (0.5000*(2*y_3 - 2*y_6))/((x_3 - x_6)^2 + (y_3 - y_6)^2 + (z_3 - z_6)^2)^0.5000,                                                                                0,                                                                                0, -(0.5000*(2*y_3 - 2*y_6))/((x_3 - x_6)^2 + (y_3 - y_6)^2 + (z_3 - z_6)^2)^0.5000,                                                                               0,                                                                                0,  (0.5000*(2*z_3 - 2*z_6))/((x_3 - x_6)^2 + (y_3 - y_6)^2 + (z_3 - z_6)^2)^0.5000,                                                                                0,                                                                                0, -(0.5000*(2*z_3 - 2*z_6))/((x_3 - x_6)^2 + (y_3 - y_6)^2 + (z_3 - z_6)^2)^0.5000]
% [                                                                              0,                                                                                0,  (0.5000*(2*x_3 - 2*x_4))/((x_3 - x_4)^2 + (y_3 - y_4)^2 + (z_3 - z_4)^2)^0.5000, -(0.5000*(2*x_3 - 2*x_4))/((x_3 - x_4)^2 + (y_3 - y_4)^2 + (z_3 - z_4)^2)^0.5000,                                                                                0,                                                                                0,                                                                               0,                                                                                0,  (0.5000*(2*y_3 - 2*y_4))/((x_3 - x_4)^2 + (y_3 - y_4)^2 + (z_3 - z_4)^2)^0.5000, -(0.5000*(2*y_3 - 2*y_4))/((x_3 - x_4)^2 + (y_3 - y_4)^2 + (z_3 - z_4)^2)^0.5000,                                                                                0,                                                                                0,                                                                               0,                                                                                0,  (0.5000*(2*z_3 - 2*z_4))/((x_3 - x_4)^2 + (y_3 - y_4)^2 + (z_3 - z_4)^2)^0.5000, -(0.5000*(2*z_3 - 2*z_4))/((x_3 - x_4)^2 + (y_3 - y_4)^2 + (z_3 - z_4)^2)^0.5000,                                                                                0,                                                                                0]
% [                                                                              0,                                                                                0,                                                                                0,  (0.5000*(2*x_4 - 2*x_5))/((x_4 - x_5)^2 + (y_4 - y_5)^2 + (z_4 - z_5)^2)^0.5000, -(0.5000*(2*x_4 - 2*x_5))/((x_4 - x_5)^2 + (y_4 - y_5)^2 + (z_4 - z_5)^2)^0.5000,                                                                                0,                                                                               0,                                                                                0,                                                                                0,  (0.5000*(2*y_4 - 2*y_5))/((x_4 - x_5)^2 + (y_4 - y_5)^2 + (z_4 - z_5)^2)^0.5000, -(0.5000*(2*y_4 - 2*y_5))/((x_4 - x_5)^2 + (y_4 - y_5)^2 + (z_4 - z_5)^2)^0.5000,                                                                                0,                                                                               0,                                                                                0,                                                                                0,  (0.5000*(2*z_4 - 2*z_5))/((x_4 - x_5)^2 + (y_4 - y_5)^2 + (z_4 - z_5)^2)^0.5000, -(0.5000*(2*z_4 - 2*z_5))/((x_4 - x_5)^2 + (y_4 - y_5)^2 + (z_4 - z_5)^2)^0.5000,                                                                                0]
% [                                                                              0,                                                                                0,                                                                                0,                                                                                0,  (0.5000*(2*x_5 - 2*x_6))/((x_5 - x_6)^2 + (y_5 - y_6)^2 + (z_5 - z_6)^2)^0.5000, -(0.5000*(2*x_5 - 2*x_6))/((x_5 - x_6)^2 + (y_5 - y_6)^2 + (z_5 - z_6)^2)^0.5000,                                                                               0,                                                                                0,                                                                                0,                                                                                0,  (0.5000*(2*y_5 - 2*y_6))/((x_5 - x_6)^2 + (y_5 - y_6)^2 + (z_5 - z_6)^2)^0.5000, -(0.5000*(2*y_5 - 2*y_6))/((x_5 - x_6)^2 + (y_5 - y_6)^2 + (z_5 - z_6)^2)^0.5000,                                                                               0,                                                                                0,                                                                                0,                                                                                0,  (0.5000*(2*z_5 - 2*z_6))/((x_5 - x_6)^2 + (y_5 - y_6)^2 + (z_5 - z_6)^2)^0.5000, -(0.5000*(2*z_5 - 2*z_6))/((x_5 - x_6)^2 + (y_5 - y_6)^2 + (z_5 - z_6)^2)^0.5000]
% [                                                                              0,                                                                                0,                                                                                0,  (0.5000*(2*x_4 - 2*x_6))/((x_4 - x_6)^2 + (y_4 - y_6)^2 + (z_4 - z_6)^2)^0.5000,                                                                                0, -(0.5000*(2*x_4 - 2*x_6))/((x_4 - x_6)^2 + (y_4 - y_6)^2 + (z_4 - z_6)^2)^0.5000,                                                                               0,                                                                                0,                                                                                0,  (0.5000*(2*y_4 - 2*y_6))/((x_4 - x_6)^2 + (y_4 - y_6)^2 + (z_4 - z_6)^2)^0.5000,                                                                                0, -(0.5000*(2*y_4 - 2*y_6))/((x_4 - x_6)^2 + (y_4 - y_6)^2 + (z_4 - z_6)^2)^0.5000,                                                                               0,                                                                                0,                                                                                0,  (0.5000*(2*z_4 - 2*z_6))/((x_4 - x_6)^2 + (y_4 - y_6)^2 + (z_4 - z_6)^2)^0.5000,                                                                                0, -(0.5000*(2*z_4 - 2*z_6))/((x_4 - x_6)^2 + (y_4 - y_6)^2 + (z_4 - z_6)^2)^0.5000]
